{% extends 'base.html' %}
{% block content %}
{% include 'navbar.html' %}

<div class="cp"> <!-- Container for the form -->
    <h1>Edit Product Entry</h1>

    <form method="POST" enctype="multipart/form-data"> <!-- Add enctype -->
        {% csrf_token %}

        <div class="form-group">
            <label for="{{ form.name.id_for_label }}">{{ form.name.label }}</label>
            {{ form.name }}
        </div>

        <div class="form-group">
            <label for="{{ form.price.id_for_label }}">{{ form.price.label }}</label>
            {{ form.price }}
        </div>

        <div class="form-group">
            <label for="{{ form.description.id_for_label }}">{{ form.description.label }}</label>
            {{ form.description }}
        </div>

        <div class="form-group">
            <label for="{{ form.shade_name.id_for_label }}">{{ form.shade_name.label }}</label>
            {{ form.shade_name }}
        </div>

        <div class="form-group">
            <label for="{{ form.stock_quantity.id_for_label }}">{{ form.stock_quantity.label }}</label>
            {{ form.stock_quantity }}
        </div>

        <!-- Preview of the existing image -->
        <div class="form-group">
            <label>Current Image:</label>
            {% if product.image %}
            <img id="current-image" src="{{ product.image.url }}" alt="Current Product Image"
                style="max-width: 200px; max-height: 200px;">
            {% else %}
            <p>No image available for this product</p>
            {% endif %}
        </div>

        <!-- New input for image upload and preview of the new image -->
        <div class="form-group">
            <label for="image">Upload New Image:</label>
            <input type="file" name="image" id="image" accept="image/*" onchange="previewImage(event)" />
            <!-- Image upload input -->
        </div>

        <!-- Container for the new image preview -->
        <div class="form-group">
            <label>New Image Preview:</label>
            <img id="new-image-preview" src="#" alt="New Image Preview"
                style="display: none; max-width: 200px; max-height: 200px;" />
        </div>

        <div class="form-group">
            <input type="submit" value="Save Changes" class="submit-btn" />
        </div>
    </form>
</div>

<script>
    // JavaScript function to preview the new image
    function previewImage(event) {
        var reader = new FileReader();
        reader.onload = function () {
            var output = document.getElementById('new-image-preview');
            output.src = reader.result;
            output.style.display = 'block'; // Show the new image preview
        };
        reader.readAsDataURL(event.target.files[0]);
    }
</script>

{% endblock content %}